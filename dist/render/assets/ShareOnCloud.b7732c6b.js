var pe=Object.defineProperty,he=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var oe=(e,o,t)=>o in e?pe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,L=(e,o)=>{for(var t in o||(o={}))me.call(o,t)&&oe(e,t,o[t]);if(ee)for(var t of ee(o))we.call(o,t)&&oe(e,t,o[t]);return e},K=(e,o)=>he(e,_e(o));import{d as v,a3 as m,a4 as y,ah as d,c0 as ge,aJ as H,a2 as B,r as P,c as N,C as ve,c1 as z,c2 as Pe,a5 as w,a6 as b,a9 as u,aa as _,ao as ke,aR as I,a8 as V,c3 as U,c4 as ne,h as p,c5 as ye,bY as te,c6 as $e,c7 as Ce,c8 as le,al as D,c9 as xe,ca as T,cb as Se,w as Z,ai as R,ad as k,bU as A,af as re,ag as be,bV as Me,cc as ae,cd as Ge}from"./main.2046a1e9.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as F}from"./Space.0022c150.js";import{_ as Ie}from"./InputNumber.26803364.js";import{_ as De}from"./FormItem.7a91dcd7.js";import{_ as ie}from"./Select.d3505bfe.js";import{_ as Be}from"./Input.866ab710.js";import{_ as Re,a as Oe}from"./Grid.73bd99ae.js";import{v as Ae,E as Ee,r as ce,u as Te,a as Ue,b as ze,c as Le,d as Ne}from"./ipcRenderer.c05eeb53.js";import{c as Fe,f as je}from"./firefox-icon.b1234872.js";import{_ as Ye}from"./Dropdown.b3c364ce.js";const He={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ve=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),We=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),qe=[Ve,We];var Tt=v({name:"CloseOutline",render:function(o,t){return m(),y("svg",He,qe)}});const Ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Je=d("path",{d:"M396 432H136c-36.44 0-70.36-12.57-95.51-35.41C14.38 372.88 0 340 0 304c0-36.58 13.39-68.12 38.72-91.22c18.11-16.53 42.22-28.25 69.18-33.87a16 16 0 0 0 11.37-9.15a156.24 156.24 0 0 1 42.05-56C187.76 91.69 220.5 80 256 80a153.57 153.57 0 0 1 107.14 42.9c24.73 23.81 41.5 55.28 49.18 92a16 16 0 0 0 12.12 12.39C470 237.42 512 270.43 512 328c0 33.39-12.24 60.78-35.41 79.23C456.23 423.43 428.37 432 396 432z",fill:"currentColor"},null,-1),Xe=[Je];var Qe=v({name:"Cloud",render:function(o,t){return m(),y("svg",Ke,Xe)}});const Ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},eo=d("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),oo=d("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),to=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M296 216v160"},null,-1),so=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M376 296H216"},null,-1),no=[eo,oo,to,so];var lo=v({name:"DuplicateOutline",render:function(o,t){return m(),y("svg",Ze,no)}});const ro={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ao=d("path",{d:"M440 432H72a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h75.89a40 40 0 0 1 22.19 6.72l27.84 18.56a40 40 0 0 0 22.19 6.72H440a40 40 0 0 1 40 40v240a40 40 0 0 1-40 40z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),io=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 192h448"},null,-1),co=[ao,io];var uo=v({name:"FolderOutline",render:function(o,t){return m(),y("svg",ro,co)}});const fo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},po=d("path",{d:"M112 111v290c0 17.44 17 28.52 31 20.16l247.9-148.37c12.12-7.25 12.12-26.33 0-33.58L143 90.84c-14-8.36-31 2.72-31 20.16z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ho=[po];var _o=v({name:"PlayOutline",render:function(o,t){return m(),y("svg",fo,ho)}});const mo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},wo=d("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),go=[wo];var vo=v({name:"ShareSocial",render:function(o,t){return m(),y("svg",mo,go)}});const Po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ko=d("path",{d:"M392 432H120a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h272a40 40 0 0 1 40 40v272a40 40 0 0 1-40 40z",fill:"currentColor"},null,-1),yo=[ko];var $o=v({name:"Stop",render:function(o,t){return m(),y("svg",Po,yo)}});const Co={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},xo=d("path",{d:"M434.67 285.59v-29.8c0-98.73-80.24-178.79-179.2-178.79a179 179 0 0 0-140.14 67.36m-38.53 82v29.8C76.8 355 157 435 256 435a180.45 180.45 0 0 0 140-66.92",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),So=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 256l44-44l46 44"},null,-1),bo=d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M480 256l-44 44l-46-44"},null,-1),Mo=[xo,So,bo];var Go=v({name:"Sync",render:function(o,t){return m(),y("svg",Co,Mo)}});const Io={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Do=d("path",{d:"M888.3 757.4h-53.8c-4.2 0-7.7 3.5-7.7 7.7v61.8H197.1V197.1h629.8v61.8c0 4.2 3.5 7.7 7.7 7.7h53.8c4.2 0 7.7-3.4 7.7-7.7V158.7c0-17-13.7-30.7-30.7-30.7H158.7c-17 0-30.7 13.7-30.7 30.7v706.6c0 17 13.7 30.7 30.7 30.7h706.6c17 0 30.7-13.7 30.7-30.7V765.1c0-4.3-3.5-7.7-7.7-7.7zm18.6-251.7L765 393.7c-5.3-4.2-13-.4-13 6.3v76H438c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 0 0 0-12.6z",fill:"currentColor"},null,-1),Bo=[Do];var Ro=v({name:"ExportOutlined",render:function(o,t){return m(),y("svg",Io,Bo)}});const Oo={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","enable-background":"new 0 0 512 512","xml:space":"preserve"},Ao=d("g",null,[d("path",{d:"M255.8,218c-21,0-38,17-38,38s17,38,38,38c21,0,38-17,38-38S276.8,218,255.8,218L255.8,218z"}),d("path",{d:"M102,218c-21,0-38,17-38,38s17,38,38,38c21,0,38-17,38-38S123,218,102,218L102,218z"}),d("path",{d:"M410,218c-21,0-38,17-38,38s17,38,38,38c21,0,38-17,38-38S431,218,410,218L410,218z"})],-1),Eo=[Ao];var To=v({name:"IosMore",render:function(o,t){return m(),y("svg",Oo,Eo)}});const q=ge("profileGroup",{state:()=>({list:[],profileGroup:{id:"",name:"",profiles:[]}}),getters:{profilesAssigned:e=>[...new Set(e.list.map(t=>t.profiles).filter(Boolean).flat())]},actions:{getGroupOfProfile(e){const o=this.list;return[...new Set(o.map((n,a)=>n.profiles.includes(e)?a:null).filter(n=>n!==null).flat())]},getProfileGroupByProfileId(e){return this.list.find(o=>o.profiles.includes(e.toString()))},async resetProfileGroupState(){this.$patch(e=>{e.profileGroup={id:"",name:"",profiles:[]}})},async addNewProfileGroup(e){return this.list.findIndex(o=>o.name===e)===-1?(this.list.push({id:Ae(),name:e,profiles:[]}),await this.resetProfileGroupState(),!0):!1},async setProfileGroup(e){this.$patch(o=>{o.profileGroup=Object.assign({},e)})},async updateProfileGroup(e,o){if(this.list.findIndex(n=>n.name===e)===-1){const n=this.list.findIndex(a=>a.id===o);return this.$patch(a=>{a.list[n].name=e}),!0}return!1},async deleteProfileGroup(e){const o=this.list.findIndex(t=>t.id===e);this.list.splice(o,1),await this.resetProfileGroupState()},async assignProfileToGroup(e,o){return this.list[e].profiles.findIndex(t=>t===o)===-1&&this.list[e].profiles.push(o),!0},async assignBulkProfiles(e,o){e.forEach(t=>{for(const n of o)this.list[t].profiles.findIndex(a=>a===n.toString())===-1&&this.list[t].profiles.push(n.toString())})},async removeProfileFromGroup(e,o){console.log("removeProfileFromGroup ~ groupId",e,o);const t=this.list.findIndex(a=>a.id===e),n=this.list[t].profiles.indexOf(o);return n!==-1&&this.list[t].profiles.splice(n,1),!0}},persist:{paths:["list"]}}),Uo=H({showCreateGroupModal:!1,showUpdateGroupModal:!1,showDeleteGroupModal:!1}),Q=q(),{list:se,profileGroup:zo}=B(Q),j=P(null),M=P([]),J=P(!1);var Lo=()=>{const e=r=>({style:"cursor: pointer;",onClick:async()=>{Q.setProfileGroup(r),j.value=L({},r),await a(r.profiles)}}),o=[{title:"Name",key:"name"},{title:"Profiles",key:"profiles.length"}],t=P(""),n=N(()=>se.value.filter(r=>r.name.includes(t.value))),a=async r=>{try{r.length?(J.value=!0,M.value=await Promise.allSettled(r.map(async s=>{const l=await z(s),{success:f,data:h}=l.data;return f?h:null})),M.value=M.value.filter(s=>s.status==="fulfilled"&&s.value).map(s=>s.value)):M.value=[]}catch(s){console.log("getProfilesInGroup ~ error",s)}finally{J.value=!1}},c=async r=>{const s=M.value.findIndex(l=>l.id===r);await Q.removeProfileFromGroup(j.value.id,r.toString()),M.value.splice(s,1)},i=async()=>{};return ve(()=>{j.value=null}),{showModals:Uo,rowProps:e,groupColumns:o,profileGroups:se,profileGroup:zo,seletedGroup:j,keywordSearch:t,searchResults:n,profiles:M,loadingProfiles:J,removeProfileFromGroup:c,confirmRemoveProfilesFromGroup:i}};const No={name:"ProfilesTableAction"},Fo=v(K(L({},No),{props:{dropDownActions:{type:Array,defualt:()=>[]},onSelect:{type:Function,default:()=>{}},trigger:{type:String,default:"click"}},setup(e){const o=e,t=N(()=>Pe(o.dropDownActions)||[]);return(n,a)=>{const c=I,i=Ye;return e.dropDownActions&&w(t).length?(m(),b(i,{key:0,trigger:e.trigger,options:w(t),onSelect:e.onSelect},{default:u(()=>[_(c,{class:"ml-10",size:"20"},{default:u(()=>[_(w(To))]),_:1})]),_:1},8,["trigger","options","onSelect"])):ke("",!0)}}})),O=V(),jo=q();B(jo);const X=P(),Y=P([]),x=P(new Set),C=H({cloneProfile:!1,assignProfile:!1,assignBulkProfiles:!1,removeProfileFromGroup:!1,deleteProfile:!1,deleteBulkProfiles:!1,exportProfile:!1,shareProfile:!1,shareOnCloud:!1,shareBulkProfilesOnCloud:!1,stopShareBulkProfilesOnCloud:!1}),G=e=>()=>p(I,null,{default:()=>p(e)}),S=P(new Set),de=async e=>{const{id:o,filename:t,permission:n}=e;try{t&&(n===T.READ||n===T.READ_WRITE)&&(x.value.add(o),await ze(e),x.value.delete(o)),S.value.add(o);const a=await Se(o),{success:c,data:i}=a.data;if(c){const r=await Le(i,o),{success:s,error:l}=r;s?O.updateProfileStatus(o,U.RUNNING):console.log(l)}}catch{}finally{S.value.delete(o)}},ue=async e=>{try{S.value.add(e);const o=await ne(e),{success:t}=o.data;t&&(O.updateProfileStatus(e,U.READY),await Ne(e)),x.value.delete(e)}catch{}finally{const o=await z(e),{data:t}=o.data,{permission:n,filename:a}=t;a&&n===T.READ_WRITE&&(await ce(t),x.value.delete(e)),S.value.delete(e)}},Yo=Te();Yo.on(Ee.PROFILE_STOPPED,async e=>{const{id:o,code:t}=e;t===0?(O.updateProfileStatus(o,U.READY),await ne(o)):O.updateProfileStatus(o,U.READY);const n=await z(o),{data:a}=n.data,{filename:c}=a;c&&(x.value.add(o),await ce(a),x.value.delete(o))});var E=()=>{const{localProfileList:e,startedProfileList:o,readyProfileList:t}=B(O),n=s=>({style:"cursor: pointer;",onClick:()=>{X.value=L({},s)}}),a=N(()=>[{type:"selection",options:["all","none",{label:"Select local profile",key:"f2",onSelect:()=>{Y.value=[...e.value]}},{label:"Select profile not running",key:"f3",onSelect:()=>{Y.value=[...t.value]}}]},{title:"Name",key:"name",width:"200",render(s){const{browser:l,name:f}=s.profile_data;return p("div",[p("img",{class:"mr-2 inline-block",src:l===ye.CHROME?Fe:je,width:"24"}),f])}},{title:"Status",key:"status",width:"100",render(s){const{id:l,status:f}=s,h=()=>{if(x.value.has(l))return p("span",null,"Syncing");if(f===U.READY)return p("span",null,"Ready");if(f===U.RUNNING)return p("span",null,"Running")};return p(F,null,{default:()=>h()})}},{title:"Proxy",key:"profile_data.proxy.type",width:"100",render(s){try{const l=Object.values(te).find(f=>f.value===s.profile_data.proxy.type);return p("span",{},l.label)}catch{return p("span",{},te.WITHOUT)}}},{title:"Last updated",key:"updated_at",width:"200",render(s){const{updated_at:l,filename:f}=s,h=$e(l);return p("div",[h.format("DD/MM/YYYY"),...f?[p(I,{size:"24",class:"ml-2",color:"#55b3e6"},{default:()=>p(Ce)})]:[]])}},{key:"actions",ellipsis:!0,fixed:"right",width:"200",render(s){const{id:l,filename:f}=s;return p("div",[(()=>x.value.has(l)?[p(D,{id:"syncBtn",type:"success",disabled:x.value.has(l),loading:x.value.has(l)},{default:()=>"Syncing",icon:()=>p(I,null,{default:()=>p(Go)})})]:[...o.value.includes(l)?[p(D,{type:"error",onClick:()=>i(s),disabled:S.value.has(s.id),loading:S.value.has(s.id)},{default:()=>"Stop",icon:()=>p(I,null,{default:()=>p($o)})})]:[p(D,{type:"primary",onClick:()=>c(s),disabled:S.value.has(s.id),loading:S.value.has(s.id)},{default:()=>"Start",icon:()=>p(I,null,{default:()=>p(_o)})})]])(),p(Fo,{trigger:"hover",dropDownActions:[{label:"Edit",key:"edit",icon:G(xe)},{label:"Assign to group",key:"assignToGroup",icon:G(uo)},{label:"Clone",key:"clone",icon:G(lo)},{type:"divider",key:"d1"},{label:"Sharing",key:"sharing",icon:G(vo)},{label:"Share on cloud",key:"shareOnCloud",icon:G(Qe)},{label:"Export",key:"export",icon:G(Ro)},{type:"divider",key:"d1"},{label:"Delete",key:"delete",icon:G(le)}],onSelect:async g=>{switch(X.value=s,g){case"edit":O.setEditProfile(s);break;case"assignToGroup":C.assignProfile=!0;break;case"removeFromGroup":C.removeProfileFromGroup=!0;break;case"clone":C.cloneProfile=!0;break;case"sharing":C.shareProfile=!0;break;case"shareOnCloud":C.shareOnCloud=!0;break;case"export":r(s);break;case"delete":C.deleteProfile=!0;break}}})])}}]),c=async s=>{try{const{id:l}=s,f=await z(l),{data:h}=f.data;await de(h)}catch{}},i=async s=>{try{const{id:l}=s;await ue(l)}catch{}},r=async s=>{await Ue(s)};return{showModals:C,rowProps:n,profileColumns:a,selectedProfile:X,selectedProfiles:Y}};const Ho=()=>{const{readyProfileList:e,startedProfileList:o}=B(O),t=[{label:"Delete",icon(){return p(I,null,{default:()=>p(le)})},key:"bulk.deleteProfiles"}],n=Y;return{bulkMoreActions:t,checkedRowKeys:n,cancelBulk:()=>{n.value=[]},startBulkProfiles:async()=>{const h=e.value.filter(g=>n.value.includes(g));await Promise.all(h.map(async g=>{const $=await z(g),{data:fe}=$.data;return de(fe)}))},stopBulkProfiles:async()=>{const h=o.value.filter(g=>n.value.includes(g));await Promise.all(h.map(g=>ue(g)))},handleSelectBulkMore:async h=>{switch(h){case"bulk.deleteProfiles":C.deleteBulkProfiles=!0;break}},assignProfilesToGroup:()=>{C.assignBulkProfiles=!0},shareProfilesOnCloud:()=>{C.shareBulkProfilesOnCloud=!0},stopShareProfilesOnCloud:()=>{C.stopShareBulkProfilesOnCloud=!0}}},Vo=k(" Removing profile "),Wo={class:"font-700"},qo=k(" from group: "),Ko={class:"font-700"},Ut=v({setup(e){const o=q(),{seletedGroup:t,removeProfileFromGroup:n}=Lo(),{showModals:a,selectedProfile:c}=E(),i=P(null);t&&(i.value=t),Z(c,s=>{s&&(i.value=o.getProfileGroupByProfileId(c.value.id))});const r=async()=>{try{window.$message.loading("Deleting...");const{id:s}=c.value;await n(s),window.$message.info("Profile removed")}catch{window.$message.info("Profile remove failed")}finally{window.$message.destroyAll()}};return(s,l)=>{const f=A;return m(),b(f,{show:w(a).removeProfileFromGroup,"onUpdate:show":l[0]||(l[0]=h=>w(a).removeProfileFromGroup=h),preset:"dialog",title:"",content:"Are you sure?","positive-text":"Remove","negative-text":"Cancel",onPositiveClick:r},{header:u(()=>{var h,g;return[d("div",null,[Vo,d("span",Wo,R((h=w(c))==null?void 0:h.profile_data.name),1),qo,d("span",Ko,R((g=i.value)==null?void 0:g.name),1)])]}),_:1},8,["show"])}}}),Jo={name:"DeleteProfileModal",setup:()=>{const e=re(),{showModals:o,selectedProfile:t}=E(),n=V(),a=P(!1),c=()=>{o.deleteProfile=!1};return{profile:t,submitted:a,showModals:o,closeModal:c,handleDeleteProfile:async()=>{try{a.value=!0,e.loading("Deleting...");const{id:r}=t.value;await n.deleteProfile(r),e.info("Profile deleted successfully"),c()}catch{e.info("Delete profile failed")}finally{a.value=!1,e.destroyAll()}}}}},Xo=k(" Delete profile: "),Qo={class:"font-700"},Zo=k(" Cancel "),et=k(" Delete ");function ot(e,o,t,n,a,c){const i=D,r=F,s=A;return m(),b(s,{show:e.showModals.deleteProfile,"onUpdate:show":o[0]||(o[0]=l=>e.showModals.deleteProfile=l),preset:"dialog",title:"",content:"Are you sure?"},{header:u(()=>[d("div",null,[Xo,d("span",Qo,R(e.profile.profile_data.name),1)])]),action:u(()=>[_(r,null,{default:u(()=>[_(i,{size:"small",disabled:e.submitted,onClick:e.closeModal},{default:u(()=>[Zo]),_:1},8,["disabled","onClick"]),_(i,{size:"small",type:"error",disabled:e.submitted,loading:e.submitted,onClick:e.handleDeleteProfile},{default:u(()=>[et]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1},8,["show"])}var zt=W(Jo,[["render",ot]]);const tt={name:"DeleteProfileModal",setup:()=>{const e=re(),{showModals:o}=E(),{checkedRowKeys:t}=Ho(),n=V(),a=P(!1),c=()=>{o.deleteBulkProfiles=!1};return{showModals:o,submitted:a,handleDeleteProfile:async()=>{try{a.value=!0,e.loading("Deleting...");const r=t.value;await n.deleteBulkProfiles(r),t.value=[],e.info("Profile deleted successfully"),c()}catch{e.info("Delete profile failed")}finally{a.value=!1,e.destroyAll()}},closeModal:c}}},st=k(" Are you sure to delete selected profiles? "),nt=k(" Cancel "),lt=k(" Delete ");function rt(e,o,t,n,a,c){const i=D,r=F,s=A;return m(),b(s,{show:e.showModals.deleteBulkProfiles,"onUpdate:show":o[0]||(o[0]=l=>e.showModals.deleteBulkProfiles=l),preset:"dialog",title:"",content:"Are you sure?"},{action:u(()=>[_(r,null,{default:u(()=>[_(i,{size:"small",disabled:e.submitted,onClick:e.closeModal},{default:u(()=>[nt]),_:1},8,["disabled","onClick"]),_(i,{size:"small",type:"error",disabled:e.submitted,loading:e.submitted,onClick:e.handleDeleteProfile},{default:u(()=>[lt]),_:1},8,["disabled","loading","onClick"])]),_:1})]),default:u(()=>[st]),_:1},8,["show"])}var Lt=W(tt,[["render",rt]]);const at={name:"CloneProfileModal",setup:()=>{const{showModals:e,selectedProfile:o}=E(),t=be(),n=V(),{profileLimit:a}=B(t),{list:c}=B(n),i=20,r=P(1),s=N(()=>a.value-c.value.length);return{selectedProfile:o,showModals:e,amountProfileCanClone:s,max:i,amountClone:r,handleCloneProfile:async()=>{if(r>i){window.$message.warning(`Only ${i} can clone at once`);return}e.cloneProfile=!1,await n.cloneProfile(o.value.profile_data,r.value)}}}},it=k(" Clone profile: "),ct={class:"font-700"},dt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},ut=d("small",{class:"text-gray-400"},"Cookies and storages won't be copied",-1);function ft(e,o,t,n,a,c){const i=Ie,r=De,s=A;return m(),b(s,{show:e.showModals.cloneProfile,"onUpdate:show":o[1]||(o[1]=l=>e.showModals.cloneProfile=l),"transform-origin":"center",preset:"dialog",title:"","positive-text":"Clone","negative-text":"Cancel",onPositiveClick:e.handleCloneProfile},{header:u(()=>[d("div",null,[it,d("span",ct,R(e.selectedProfile.profile_data.name),1)])]),default:u(()=>[d("div",dt,[_(r,{label:`Number of copies (Max ${e.max} at once)`,"show-feedback":!1},{default:u(()=>[_(i,{value:e.amountClone,"onUpdate:value":o[0]||(o[0]=l=>e.amountClone=l),placeholder:"",max:e.max},null,8,["value","max"])]),_:1},8,["label"]),ut])]),_:1},8,["show","onPositiveClick"])}var Nt=W(at,[["render",ft]]);const pt={name:"ShareProfileModal",setup:()=>{const{showModals:e,selectedProfile:o}=E(),t=H({targetInvite:"",selectedRight:"1",submitting:!1}),n=[{label:"Read",value:T.READ},{label:"Read + Write",value:T.READ_WRITE}],a=()=>{e.shareProfile=!1,t.targetInvite="",t.selectedRight=T.READ,t.submitting=!1},c=async()=>{if(!t.targetInvite){window.$message.warning("Target cannot be blank");return}try{t.submitting=!0;const{id:i}=o.value;await ae({id:i,share_status:!0});const r={id:i,user_email:t.targetInvite,user_permission:t.selectedRight.toString()},s=await Ge(r),{success:l}=s.data;l?(window.$message.success("User added"),e.shareProfile=!1):window.$message.warning("User not found")}catch{}finally{t.targetInvite="",t.selectedRight="1",t.submitting=!1}};return K(L({selectedProfile:o,showModals:e},Me(t)),{rights:n,closeModal:a,shareProfile:c})}},ht=k(" Share profile: "),_t={class:"font-700"},mt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},wt=k(" Invite ");function gt(e,o,t,n,a,c){const i=Be,r=Re,s=ie,l=D,f=Oe,h=F,g=A;return m(),b(g,{id:"share-modal",show:e.showModals.shareProfile,"onUpdate:show":o[2]||(o[2]=$=>e.showModals.shareProfile=$),"transform-origin":"center",preset:"dialog"},{header:u(()=>[d("div",null,[ht,d("span",_t,R(e.selectedProfile.profile_data.name),1)])]),default:u(()=>[d("div",mt,[_(f,{"x-gap":"12",cols:8},{default:u(()=>[_(r,{span:"4"},{default:u(()=>[_(i,{value:e.targetInvite,"onUpdate:value":o[0]||(o[0]=$=>e.targetInvite=$),placeholder:"Invite someone..."},null,8,["value"])]),_:1}),_(r,{span:"2"},{default:u(()=>[_(s,{value:e.selectedRight,"onUpdate:value":o[1]||(o[1]=$=>e.selectedRight=$),options:e.rights,"consistent-menu-width":!1},null,8,["value","options"])]),_:1}),_(r,null,{default:u(()=>[_(l,{type:"primary",loading:e.submitting,onClick:e.shareProfile},{default:u(()=>[wt]),_:1},8,["loading","onClick"])]),_:1})]),_:1}),_(h,{vertical:""})])]),_:1},8,["show"])}var Ft=W(pt,[["render",gt]]);const vt=d("div",null,"Assign to group",-1),Pt={class:"d-flex flex-row mt-3 mb-2 align-items-center"},jt=v({setup(e){const{showModals:o,selectedProfile:t}=E(),n=q(),{list:a}=B(n),c=P([]);Z(()=>o.assignProfile,l=>{l&&(c.value=n.getGroupOfProfile(t.value.id.toString()))});const i=N(()=>a.value.map((l,f)=>({label:l.name,value:f}))),r=()=>{c.value=[],o.assignProfile=!1},s=async()=>{try{window.$message.loading("Assigning..."),await Promise.all(c.value.map(async l=>await n.assignProfileToGroup(l,t.value.id.toString()))),window.$message.success("Profile assigned"),r()}catch{window.$message.info("Profile assign failed")}finally{window.$message.destroyAll()}};return(l,f)=>{const h=ie,g=A;return m(),b(g,{show:w(o).assignProfile,"onUpdate:show":f[1]||(f[1]=$=>w(o).assignProfile=$),"transform-origin":"center",preset:"dialog",title:"","positive-text":"Assign","negative-text":"Cancel","on-mask-click":r,onPositiveClick:s,onNegativeClick:r},{header:u(()=>[vt]),default:u(()=>[d("div",Pt,[_(h,{value:c.value,"onUpdate:value":f[0]||(f[0]=$=>c.value=$),filterable:"",multiple:"",options:w(i)},null,8,["value","options"])])]),_:1},8,["show"])}}}),kt={key:0},yt={key:1},$t={class:"font-700"},Ct=k(" Cancel "),Yt=v({setup(e){const{showModals:o,selectedProfile:t}=E(),n=H({status:!0,submitted:!1});Z(()=>o.shareOnCloud,async()=>{n.status=!0;const{id:c}=t.value,i=await z(c),{data:r}=i.data;r.filename&&(n.status=!1)});const a=async()=>{try{n.submitted=!0,window.$message.loading("Sharing...");const{id:c}=t.value,i=await ae({id:c,share_status:n.status});n.status?window.$message.info("Profile shared on cloud"):window.$message.info("Profile stopped share on cloud")}catch{window.$message.info("Delete share failed")}finally{n.submitted=!1,window.$message.destroyAll(),o.shareOnCloud=!1}};return(c,i)=>{const r=F,s=D,l=A;return m(),b(l,{show:w(o).shareOnCloud,"onUpdate:show":i[1]||(i[1]=f=>w(o).shareOnCloud=f),preset:"dialog",content:"Are you sure?"},{header:u(()=>[d("div",null,[_(r,null,{default:u(()=>[w(n).status?(m(),y("span",kt,"Share on cloud:")):(m(),y("span",yt,"Stop share on cloud:")),d("span",$t,R(w(t).profile_data.name),1)]),_:1})])]),action:u(()=>[_(r,null,{default:u(()=>[_(s,{size:"small",onClick:i[0]||(i[0]=f=>w(o).shareOnCloud=!w(o).shareOnCloud)},{default:u(()=>[Ct]),_:1}),_(s,{size:"small",type:w(n).status?"primary":"error",loading:w(n).submitted,disabled:w(n).submitted,onClick:a},{default:u(()=>[k(R(w(n).status?"Share":"Stop"),1)]),_:1},8,["type","loading","disabled"])]),_:1})]),_:1},8,["show"])}}});export{uo as A,Tt as C,zt as D,To as I,_o as S,Yt as _,Ho as a,q as b,$o as c,Lt as d,Nt as e,Ft as f,jt as g,Ut as h,Lo as i,E as u};
