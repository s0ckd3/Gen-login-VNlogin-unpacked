import{d as S,aJ as C,r as b,ag as T,ae as L,C as U,an as A,a3 as _,a4 as B,ah as d,a5 as a,a6 as y,a9 as o,aa as s,bG as w,ad as p,ai as E,bS as $,bT as I,al as V,bH as H}from"./main.2046a1e9.js";import{N as M}from"./headers.b197b409.js";import{_ as j}from"./Input.866ab710.js";import{_ as D}from"./FormItem.7a91dcd7.js";import{_ as F}from"./Space.0022c150.js";import{_ as G}from"./Form.8d4e23b3.js";import"./Suffix.8c4bc0ef.js";import"./use-merged-state.82643886.js";import"./get.dca81cb3.js";const J={class:"login-wrapper"},O={class:"login-container"},P={class:"block mt-2"},z=p(" Register "),K={class:"block mt-2"},Q=p(" Active "),W={class:"mt-5 flex justify-center"},X=p(" Login "),Y=S({setup(Z){const e=C({submitting:!1,firstName:"",lastName:"",email:"",password:"",verifyToken:"",step:"register"}),f=b(null),k=b(null),g=T(),h=L(),N=async()=>{if(e.submitting)return;const{firstName:r,lastName:t,email:n,password:l}=e,u={first_name:r.trim(),last_name:t.trim(),email:n.trim(),password:l};try{e.submitting=!0;const m=await $(u),{success:c,msg:v}=m.data;if(c){e.step="confirm",window.$message.success("Register success");return}}catch{}finally{e.submitting=!1}},x=async()=>{const r={username:e.email,password:e.password};try{const t=await H(r);if(t){const{data:n}=t.data;await g.$patch({keepLogin:!1,keepLoginInfo:null}),await g.setAuth(n),h.push({name:"main.home"}),window.$message.success("Login success")}}catch{}finally{e.submitting=!1}},R=async()=>{if(!e.submitting)try{e.submitting=!0;const r={email:e.email,verify_token:e.verifyToken},t=await I(r),{success:n}=t.data;if(n){window.$message.success("Email verified success"),await x();return}}catch{}finally{e.submitting=!1}};return U(()=>{f.value.focus()}),(r,t)=>{const n=j,l=D,u=V,m=F,c=G,v=M,q=A("router-link");return _(),B("div",J,[d("div",O,[a(e).step==="register"?(_(),y(c,{key:0,id:"form-login",onSubmit:w(N,["prevent"])},{default:o(()=>[s(l,{required:"",label:"First name"},{default:o(()=>[s(n,{ref_key:"firstInputRef",ref:f,value:a(e).firstName,"onUpdate:value":t[0]||(t[0]=i=>a(e).firstName=i),autofocus:"",required:"",type:"text",placeholder:""},null,8,["value"])]),_:1}),s(l,{required:"",label:"Last name"},{default:o(()=>[s(n,{value:a(e).lastName,"onUpdate:value":t[1]||(t[1]=i=>a(e).lastName=i),required:"",type:"text",placeholder:""},null,8,["value"])]),_:1}),s(l,{required:"",label:"Email"},{default:o(()=>[s(n,{value:a(e).email,"onUpdate:value":t[2]||(t[2]=i=>a(e).email=i),required:"",placeholder:""},null,8,["value"])]),_:1}),s(l,{required:"",label:"Password"},{default:o(()=>[s(n,{value:a(e).password,"onUpdate:value":t[3]||(t[3]=i=>a(e).password=i),required:"",type:"password"},null,8,["value"])]),_:1}),s(m,{vertical:""},{default:o(()=>[d("div",P,[s(u,{"attr-type":"submit",type:"primary",block:"",strong:"",disabled:a(e).submitting},{default:o(()=>[z]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["onSubmit"])):(_(),y(c,{key:1,id:"form-login",onSubmit:w(R,["prevent"])},{default:o(()=>[s(v,{class:"text-center"},{default:o(()=>[p(" The activation code was send "+E(a(e).email),1)]),_:1}),s(l,{required:"",label:"Confirm code"},{default:o(()=>[s(n,{ref_key:"confirmCodeRef",ref:k,value:a(e).verifyToken,"onUpdate:value":t[4]||(t[4]=i=>a(e).verifyToken=i),required:"",type:"text",placeholder:""},null,8,["value"])]),_:1}),d("div",K,[s(u,{id:"confirm-button","attr-type":"submit",type:"primary",block:"",strong:"",disabled:a(e).submitting},{default:o(()=>[Q]),_:1},8,["disabled"])])]),_:1},8,["onSubmit"])),d("div",W,[s(q,{to:"/login",class:"text-blue-500"},{default:o(()=>[X]),_:1})])])])}}});var ue=Y;export{ue as default};
